#!/bin/bash

PORT={{ redis_confs.port }}
HOSTS_NAMES="{{ groups['redis'] | join(' ')}}"
REPLICAS={{ redis_cluster_replicas }}
REDIS_PATH={{ redis_install_path }}

HOSTS="";

for h in $HOSTS_NAMES; do
  HOSTS="$HOSTS $h:$PORT"
done

$REDIS_PATH/src/redis-trib.rb create --replicas $REPLICAS $HOSTS

